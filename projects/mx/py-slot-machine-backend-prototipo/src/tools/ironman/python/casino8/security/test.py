#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Copyright (c) 2013 Asumi Kamikaze Inc.
# Copyright (c) 2013 The Octopus Apps Inc.
# Licensed under the Apache License, Version 2.0 (the "License")
# Author: Alejandro M. Bernardis
# Email: alejandro.bernardis at gmail.com
# Created: 31/07/2013 18:05

from casino8.security.iron_man import *

# ------------------------------------------------------------------------------
# ks = ['6P2w4h', '55I7Jy', 'h445zT', 'k8P7K2', '89F4zU', '8FZ18v', 'T9jc93',
#       'C2e6Y8', '33eCj3', 'P666CU', 'k76K7z', 'b1P91z', 'T487Dy', 'e144rw',
#       'R463Ol', 'JD2i46', 'q99S5k', '707EyK', 'XdA593', 'C38B2m', '4en56s',
#       'sF294b', '42CJ8Z', '615wGX', '3cMP49', 'Wrt658', '9BI7z2', 'x2pk11',
#       '5naP05', 'j7V6m6', '7LGP31', '98fZ9o', 'bww606', '4Li48o', 'f4Jl42',
#       '2E28yA', '98ad9P', '1da71h', '3i39Tm', '8C29oM', '6Hk8S4', 'W8m58t',
#       '29sqQ8', '91h7hp', 'M265Fh', '836teu', '7y5K2Y', '363uHb', '8o4fz2',
#       '19KU0q', 'f2z8t0', '85S7Bw', 'G6oY22', 'yWU415', '11E9cW', '1R9pJ2',
#       'zH78B7', '9OA11E', 'K9V07X', '96wh2J', '998tro', 'L2O45Z', 'g79Ok0',
#       '83s4rb', '52cm8X', 'O4U8w2', 'B8Is05', '3R7fS8', 'Z3F4H1', 'qN2f21',
#       '8ZUp80', 'V8gB92', 'a1I41T', 'Qk192E', '5wt5r6', '38wSl2', 'w28x2m',
#       '7Z3eT4', 'a5Le92', '343ily', '79Nt9v', '11ThX3', 'gI8s33', '22Q4DQ',
#       'iF43g3', '70Z6Zz', '5G5zx6', '9g0N3c', 'o30yf1', 's6qD90', '7r2L9y',
#       'M2a9k0', '53B5Lf', 'YEr771', '1Cg61K', '8moG98', '60LF4o', '5J5Le9',
#       '8S8rj7', '24Ll4H']
# for i in ks:
#     k = 'Ac00-DS90210OIUkH-WB7891-WyX0'
#     l = '^0000/00/00|00:00:00.0000|latinocasino.net|%s$' % i
#     v = IronMan.doit(l, k)
#     vk = 'I%s|%s' % (v, k)
#     print IronManDefense.action(vk), '---', vk, '\n'+('-'*80)
# ------------------------------------------------------------------------------

ks = [
    'I10611211600401002600812600200300405700903001201311312303101210800200000'
    '407609308506809004409203408507104708809110804208007707312212610006400511'
    '2028|4BD5958F-35E8-68BA-5B00001403B3A44F6',

    'I02411500300400502500101300200000706200803000900411312303011402811212208'
    '104108104908909304508003207104209204510404708606507400711408202700112510'
    '2|FA356615-06B9-31BA-C2DB-E0E03B3A4C2B',

    'I10311200200300210800312300211811607911203000800300101103000302701511502'
    '507204003506509004409203408505308909408610809208706906300111909704211312'
    '3101|9B221C3C-FE3A-2621-258D-4DB53B3A4F00',

    'I10511300711900610611612200200211705800903000811811312403011403100001407'
    '609208006408909304508003207009004304102504508205007311502011209000604409'
    '8|7C7F5EDB-2DF8-2CBF-A139001403B3A53EF',

    'I02711900200900610500600900200700207200503000311311900203000202301011302'
    '507609308506809004409203408407104704704210709209306505801409802106908900'
    '3016|EE285F61-7344-9DD8-199A-01403B3A54FA',

    'I10511300700000502800201400211300407911203012711900712703000503000011602'
    '107504608706609004409203408407508008808810908908406607906500009200501200'
    '3101|7C716326-A53A-EB4E-102F-7B663B3A5896',

    'I10611911411400410900501000200300706300203001300300401103011410800500007'
    '609208006408909304508003207004704409102604303905507511309200102010309110'
    '3|4EBC7B52-36C3-7671-DB00001403B3A5FB4',

    'I02800500800601110500512200211600206811702401211900400302400611100300602'
    '907609308506809004408708103905304708604502508608207605800612209002309501'
    '0096|B7878F5B-D38D-6F69-3A51-01403B82FFF8'
]

hs = []

for i, d in enumerate(ks):
    h = 'I%s' % IronMan.doit(d, SECRET_HASH)
    hs.append(h)
    #print i, '*'
    #print 'D:', d
    #print 'H:', h
    #print '-' * 160

for i, d in enumerate(hs):
    print '*', i
    print 'D:', d
    h = IronMan.rdoit(d[1:], SECRET_HASH)
    print 'R:', h
    h = h.split(SEPARATOR)
    h = IronMan.rdoit(h[0][1:], h[1])
    print 'R:', h
    if not IronMan.defense(d):
        print 'ERROR *** %s' % h
    print '-' * 160